{"version":3,"file":"Registry.js","names":["_underscore","_interopRequireDefault","require","_objectPath","_uuid","obj","__esModule","default","ownKeys","e","r","t","Object","keys","getOwnPropertySymbols","o","filter","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","arguments","length","forEach","_defineProperty","getOwnPropertyDescriptors","defineProperties","defineProperty","key","value","_toPropertyKey","configurable","writable","_typeof","Symbol","iterator","constructor","prototype","_slicedToArray","arr","i","_arrayWithHoles","_iterableToArrayLimit","_unsupportedIterableToArray","_nonIterableRest","TypeError","minLen","_arrayLikeToArray","n","toString","call","slice","name","Array","from","test","len","arr2","l","u","a","f","next","done","return","isArray","_classCallCheck","instance","Constructor","_defineProperties","target","props","descriptor","_createClass","protoProps","staticProps","_toPrimitive","toPrimitive","String","Number","Registry","exports","idField","mode","undefined","MODES","HISTORY","__name","__idField","__registered","__protected","__unregister","__banned","__subscribers","__mode","get","values","_this","unregister","banned","registered","item","_","chain","sortBy","indexBy","listById","set","newMode","id","defaultValue","op","isProtected","isRegistered","findWhere","isUnRegistered","isBanned","ban","_this2","ids","flatten","CLEAN","cleanup","notify","type","_this3","_$flatten","_$flatten2","remove","flush","protect","_this4","register","data","uuid","Error","concat","del","unprotect","_this5","_this6","uniq","subscribe","cb","_this7","unsubscribe","unsubscribeAll","context","_this8","entries","_ref","_ref2"],"sources":["../src/Registry.js"],"sourcesContent":["import _ from 'underscore';\nimport op from 'object-path';\nimport { v4 as uuid } from 'uuid';\n\nexport class Registry {\n    constructor(name, idField, mode = Registry.MODES.HISTORY) {\n        this.__name = name || 'Registry';\n        this.__idField = idField || 'id';\n        this.__registered = [];\n        this.__protected = {};\n        this.__unregister = {};\n        this.__banned = {};\n        this.__subscribers = {};\n        this.__mode = mode in Registry.MODES ? mode : Registry.MODES.HISTORY;\n    }\n\n    get protected() {\n        return Object.values(this.__protected);\n    }\n\n    get registered() {\n        return this.__registered;\n    }\n\n    get unregistered() {\n        return Object.values(this.__unregister);\n    }\n\n    get banned() {\n        return Object.values(this.__banned);\n    }\n\n    get listById() {\n        const unregister = this.__unregister;\n        const banned = this.__banned;\n        const registered = Array.from(this.__registered).filter(\n            (item) =>\n                !(item[this.__idField] in unregister) &&\n                !(item[this.__idField] in banned),\n        );\n\n        return _.chain(registered)\n            .sortBy('order')\n            .indexBy(this.__idField)\n            .value();\n    }\n\n    get list() {\n        return Object.values(this.listById);\n    }\n\n    set mode(newMode = Registry.MODES.HISTORY) {\n        this.__mode =\n            newMode in Registry.MODES ? newMode : Registry.MODES.HISTORY;\n    }\n\n    get mode() {\n        return this.__mode;\n    }\n\n    get(id, defaultValue) {\n        return op.get(this.listById, [id], defaultValue);\n    }\n\n    isProtected(id) {\n        return id in this.__protected;\n    }\n\n    isRegistered(id) {\n        return !!_.findWhere(this.__registered, { id });\n    }\n\n    isUnRegistered(id) {\n        return !(id in this.listById);\n    }\n\n    isBanned(id) {\n        return id in this.__banned;\n    }\n\n    ban(id) {\n        const ids = _.flatten([id]);\n        ids.forEach((id) => op.set(this.__banned, [id], id));\n\n        if (this.__mode === Registry.MODES.CLEAN) {\n            this.cleanup(id);\n        }\n\n        this.notify({ type: 'ban', id });\n\n        return this;\n    }\n\n    cleanup(id) {\n        const [remove] = _.flatten([id]);\n        if (this.isProtected(remove)) return this;\n\n        this.__registered = this.__registered.filter(\n            (item) => item[this.__idField] !== remove,\n        );\n\n        this.notify({ type: 'cleanup', id });\n\n        return this;\n    }\n\n    flush() {\n        this.__registered = [];\n        this.__protected = {};\n        this.__unregister = {};\n        this.__banned = {};\n\n        this.notify({ type: 'flush' });\n    }\n\n    protect(id) {\n        const ids = _.flatten([id]);\n        ids.forEach((id) => op.set(this.__protected, [id], id));\n\n        this.notify({\n            type: 'protect',\n            id,\n        });\n\n        return this;\n    }\n\n    register(id, data = {}) {\n        // one argument register\n        if (typeof id === 'object' && this.__idField in id) {\n            data = id;\n            id = data[this.__idField];\n        }\n\n        if (!id) id = uuid();\n        if (this.isBanned(id)) {\n            return new Error(\n                `${this.__name} unable to register banned item ${id}`,\n            );\n        }\n\n        if (this.isProtected(id) && this.isRegistered(id)) {\n            return new Error(\n                `${this.__name} unable to replace protected item ${id}`,\n            );\n        }\n\n        data['order'] = op.get(data, 'order', 100);\n        const item = { ...data, [this.__idField]: id };\n\n        if (this.__mode === Registry.MODES.CLEAN) {\n            this.cleanup(id);\n        }\n\n        this.__registered.push(item);\n        op.del(this.__unregister, [id]);\n\n        this.notify({\n            type: 'register',\n            id,\n            data: item,\n        });\n\n        return this;\n    }\n\n    unprotect(id) {\n        const ids = _.flatten([id]);\n        ids.forEach((id) => op.del(this.__protected, id));\n\n        this.notify({\n            type: 'unprotect',\n            id,\n        });\n\n        return this;\n    }\n\n    unregister(id) {\n        if (!id) return this;\n\n        const ids = _.chain([id]).flatten().uniq().value();\n\n        ids.forEach((id) => {\n            if (id in this.__protected) return;\n\n            if (this.__mode === Registry.MODES.CLEAN) {\n                this.cleanup(id);\n                return;\n            }\n\n            op.set(this.__unregister, [id], id);\n        });\n\n        this.notify({\n            type: 'unregister',\n            id,\n        });\n\n        return this;\n    }\n\n    subscribe(cb, id) {\n        if (!id) id = uuid();\n\n        if (typeof cb === 'function') {\n            this.__subscribers[id] = cb;\n        }\n\n        return () => this.unsubscribe(id);\n    }\n\n    unsubscribe(id) {\n        op.del(this.__subscribers, [id]);\n    }\n\n    unsubscribeAll() {\n        this.__subscribers = {};\n    }\n\n    notify(context) {\n        Object.entries(this.__subscribers).forEach(([id, cb]) => {\n            if (typeof cb === 'function') cb(this, context);\n        });\n    }\n}\n\nRegistry.MODES = {\n    HISTORY: 'HISTORY',\n    CLEAN: 'CLEAN',\n};\n"],"mappings":"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","ignoreList":[]}